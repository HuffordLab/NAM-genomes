# AGP generation steps

## Process GoldenGate Markers and generate mapped marker file

This is done for each NAM, replace the NAM with the actual NAM name and run it on each NAM scaffolds (except B73 and B73Ab10)
The map files for each NAM should be placed in their own folder


### Mo18W example run:

#### Step 0

build index for your scaffolds:

```bash
00_build_index_hisat2.sh Mo18W.scaffolds.fasta
```


#### Step 1

```bash
for f in *.map; do
  gg1_ProcessMaizeGDBmaps.sh $f NAM-name;
done
```

Stdout:
```
For M018W Chr 1, orignal file had 113 markers, but only 103 had information and 103 sequences were able to extract
For M018W Chr 2, orignal file had 75 markers, but only 65 had information and 65 sequences were able to extract
For M018W Chr 3, orignal file had 85 markers, but only 72 had information and 72 sequences were able to extract
For M018W Chr 4, orignal file had 76 markers, but only 64 had information and 64 sequences were able to extract
Feature (5:229199657-229199757) beyond the length of 5 size (217959525 bp).  Skipping.
For M018W Chr 5, orignal file had 88 markers, but only 79 had information and 78 sequences were able to extract
For M018W Chr 6, orignal file had 49 markers, but only 39 had information and 39 sequences were able to extract
For M018W Chr 7, orignal file had 46 markers, but only 39 had information and 39 sequences were able to extract
For M018W Chr 8, orignal file had 56 markers, but only 43 had information and 43 sequences were able to extract
For M018W Chr 9, orignal file had 57 markers, but only 46 had information and 46 sequences were able to extract
For M018W Chr 10, orignal file had 35 markers, but only 31 had information and 31 sequences were able to extract
```

You will see `.fasta` and `.tsv` for each chr separately

#### Step 2

```bash
gg2_MergeMarkers.sh M018W
```

No stdout, but you will see:

```
M018W_merged.fasta
M018W_merged.txt
```

as output

#### Step 3

Map markers

```bash
gg3_MapMarkers.sh \
   /work/LAS/mhufford-lab/arnstrm/Canu_1.8/genetic_maps/Mo18W/Mo18W_index/Mo18W \
   M018W_merged.fasta \
   M018W_merged.txt M018W
```

No stdout, but few files are generated by this script.

```
M018W_mapped.sam
mapping_stats.txt
M018W_mapped.bam
M018W_sorted.bam
M018W_sorted-q30.bam
M018W_sorted_noMismatch.bam
M018W_part1.txt
M018W_part2.txt
M018W_GG-mapped.csv
```

The file `M018W_GG-mapped.csv` is needed for the ALLMAPS step later.



